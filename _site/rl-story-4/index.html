<!DOCTYPE html>
<html>
  <head>
    <title>강화 학습 이야기 4 – JunHyoung Ryu's Blog</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="정책 \(\pi\)의 행동을 교정하기 위해 가치 함수 \(Q^{\pi}(s, a)\)와 \(V^{\pi}(s)\)를 소개했다. 낭비를 줄이기 위해 \(V^{\pi}\)만 이용하기로 했다. 그래서 \(V^{\pi}\)를 시간차 학습으로 추정하는 방법에 대해 이야기했다. \(Q^{\pi}(s, a)\) 역시 시간차 학습으로 추정할 수 있다.
" />
    <meta property="og:description" content="정책 \(\pi\)의 행동을 교정하기 위해 가치 함수 \(Q^{\pi}(s, a)\)와 \(V^{\pi}(s)\)를 소개했다. 낭비를 줄이기 위해 \(V^{\pi}\)만 이용하기로 했다. 그래서 \(V^{\pi}\)를 시간차 학습으로 추정하는 방법에 대해 이야기했다. \(Q^{\pi}(s, a)\) 역시 시간차 학습으로 추정할 수 있다.
" />
    
    <meta name="author" content="JunHyoung Ryu's Blog" />

    
    <meta property="og:title" content="강화 학습 이야기 4" />
    <meta property="twitter:title" content="강화 학습 이야기 4" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="JunHyoung Ryu's Blog - zero-calorie ideas." href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/images/jekyll-logo.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">JunHyoung Ryu's Blog</a></h1>
            <p class="site-description">zero-calorie ideas.</p>
          </div>

          <nav>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>강화 학습 이야기 4</h1>


  <div class="entry">
    <p>정책 \(\pi\)의 행동을 교정하기 위해 가치 함수 \(Q^{\pi}(s, a)\)와 \(V^{\pi}(s)\)를 소개했다. 낭비를 줄이기 위해 \(V^{\pi}\)만 이용하기로 했다. 그래서 \(V^{\pi}\)를 시간차 학습으로 추정하는 방법에 대해 이야기했다. \(Q^{\pi}(s, a)\) 역시 시간차 학습으로 추정할 수 있다.</p>

\[Q^{\pi}(s, a) \approx r + Q^{\pi}(s', a')\]

<p>필요한 데이터는 \((s,\ a,\ r,\ s',\ a')\)다. 행위자가 개입한 흔적은 \(a'\)에서만 드러난다. 지난 이야기에서 꼼꼼히 따져 봤다.</p>

<p>그러나 잘 생각해보자. 가치 함수 \(Q^{\pi}\)만 가지고도 해야 할 행동이 무엇인지 충분히 추론할 수 있다. 가장 높은 누적 보상을 기대할 수 있는 행동을 하면 된다. 그러나 그렇게 행동하는 정책은 \(Q^{\pi}\)를 정의하는 정책 \(\pi\)와 다르다는 점이 재밌다.</p>

<h2 id="헬리콥터-부모">헬리콥터 부모</h2>

<p>가능한 행동이 \(a_1\)와 \(a_2\) 뿐이고 \(Q^{\pi}(s, a_1)\) \(&gt;\) \(Q^{\pi}(s, a_2)\)라 하자. 정책 \(\pi\)는 \(s\)에서 \(a_1\)와 \(a_2\) 중 무엇을 선호할까? 모른다. \(\pi\)는 \(a_2\)를 더 선호할 수도 있다. 그러나 만약 우리가 행동을 강제할 수 있다면 당연히 \(a_1\)를 고른다. 물론 \(a_1\)가 정말로 좋은 행위인지는 모른다. 적어도 그 이후에 \(\pi\)에 따라 행동한다면 \(a_1\)를 하는게 가장 좋다는 말이다.</p>

<p>전형적인 부모 자식의 관계다. 부모는 자식의 정책 \(\pi\)의 가치 \(Q^{\pi}(s, a)\)를 추산하려 무던히도 노력한다. 자식 \(\pi\)에게 \(Q^{\pi}\)가 가장 높은 행동들만 할 것을 강요한다. 부모의 명령을 따라 행동하는 것이 자식의 새로운 정책 \(\pi'\)가 된다. 부모는 \(Q^{\pi'}(s, a)\)를 추산해 다시금 자식의 행동을 교정한다.</p>

<p>이러한 방법론을 살사라 부른다. \(Q^{\pi}\)를 시간차 학습으로 추정하기 위해 필요한 데이터를 그대로 읽은 펀치라인이다. 이를 알고리즘으로 써 보자.</p>

<ol>
  <li>\(Q^{\pi}(s, a)\)를 가장 크게 만드는 행동만을 하는 새로운 정책 \(\pi'\)를 이용해 데이터를 모은다.</li>
  <li>\(\pi'\)의 가치함수 \(Q^{\pi'}(s, a)\)를 추정한다.</li>
  <li>\(\pi\) \(\leftarrow\) \(\pi'\)</li>
</ol>

<p>정책 \(\pi'\)를 표현하는 신경망 따위가 없다는 것에 주목하자. 이전 정책의 가치 함수 \(Q^{\pi}\)가 간접적으로 \(\pi'\)를 정의한다. 마찬가지로 \(\pi'\)의 가치 함수 \(Q^{\pi'}\)는 새로운 정책 \(\pi''\)을 정의한다. 반복한다.</p>

<p>일부러 비극적인 비유를 들어 보았다. 살사는 현실적으로 사용하는 방법론이 아니기 때문이다. 부모의 판단에 의존하는 자식의 삶은 불행하다. 더 나은 방법론은 다음 이야기에서 다룬다.</p>

  </div>

  <div class="date">
    20년 6월의 기록
  </div>


  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'junhsss-github-io';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


  
    <div id="disqus_thread"></div>
    <script>

      /**
      *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
      *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

      var disqus_config = function () {
        this.page.url = "http://localhost:4000/rl-story-4/";
        this.page.identifier = "강화 학습 이야기 4";
      };

      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://junhsss-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                
  
</article>

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    </div>
    <!--
    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/barryclark/jekyll-now"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/jekyllrb"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>
    -->

    

  </body>
</html>

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>